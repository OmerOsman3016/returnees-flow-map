<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="description" content="Sudan | Displacement Tracking Matrix-Returnees Flow" />
  <title>Sudan | Displacement Tracking Matrix - Returnees Flow</title>

  <!-- External CSS libraries -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.min.css" />
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chroma-js/2.1.2/chroma.min.js"></script>

  <style>
    /* Loading spinner styles */
    #loading-spinner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    
    .spinner {
      width: 80px;
      height: 80px;
      position: relative;
      margin-bottom: 20px;
    }
    
    .spinner-dot {
      position: absolute;
      width: 16px;
      height: 16px;
      background: #418FDE;
      border-radius: 50%;
      animation: spinner-animation 2s infinite ease-in-out;
    }
    
    .spinner-dot:nth-child(1) {
      top: 0;
      left: 32px;
      animation-delay: 0s;
    }
    
    .spinner-dot:nth-child(2) {
      top: 8px;
      left: 8px;
      animation-delay: -0.4s;
    }
    
    .spinner-dot:nth-child(3) {
      top: 32px;
      left: 0;
      animation-delay: -0.8s;
    }
    
    .spinner-dot:nth-child(4) {
      top: 56px;
      left: 8px;
      animation-delay: -1.2s;
    }
    
    .spinner-dot:nth-child(5) {
      top: 64px;
      left: 32px;
      animation-delay: -1.6s;
    }
    
    .spinner-dot:nth-child(6) {
      top: 56px;
      left: 56px;
      animation-delay: -2s;
    }
    
    .spinner-dot:nth-child(7) {
      top: 32px;
      left: 64px;
      animation-delay: -2.4s;
    }
    
    .spinner-dot:nth-child(8) {
      top: 8px;
      left: 56px;
      animation-delay: -2.8s;
    }
    
    @keyframes spinner-animation {
      0%, 100% {
        transform: scale(0.1);
        opacity: 0.5;
      }
      50% {
        transform: scale(1);
        opacity: 1;
      }
    }
    
    .loading-text {
      font-size: 18px;
      color: #418FDE;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% {
        opacity: 0.6;
      }
      50% {
        opacity: 1;
      }
    }
    
    .loading-progress {
      width: 200px;
      height: 4px;
      background: #e0e0e0;
      border-radius: 2px;
      margin-top: 15px;
      overflow: hidden;
    }
    
    .loading-progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #418FDE, #82C4FF);
      transition: width 0.3s ease;
      border-radius: 2px;
    }

    /* General body styling */
    body {
      margin: 20px;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #FFFFFF;
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.6;
      letter-spacing: 0.5px;
      font-size: 16px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      opacity: 0;
      animation: fadeIn 1.5s ease-in-out forwards;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    *, *::before, *::after { box-sizing: inherit; }

    a {
      color: #0033A0;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    a:hover { color: #0056b3; }

    /* Custom scrollbar */
    body::-webkit-scrollbar { width: 10px; }
    body::-webkit-scrollbar-track { background: #f1f1f1; }
    body::-webkit-scrollbar-thumb { background: #888; border-radius: 5px; }
    body::-webkit-scrollbar-thumb:hover { background: #555; }
  
    /* Slideshow container */
    .slideshow-container {
      max-width: 100%;
      position: relative;
      margin: 20px 0;
    }

    /* Slides */
    .slide {
      display: none;
      width: 100%;
      text-align: center;
    }

    .slide img {
      width: 100%;
      max-height: 500px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Next & previous buttons */
    .prev, .next {
      cursor: pointer;
      position: absolute;
      top: 50%;
      width: auto;
      padding: 16px;
      margin-top: -22px;
      color: white;
      font-weight: bold;
      font-size: 18px;
      transition: 0.6s ease;
      border-radius: 0 3px 3px 0;
      background-color: rgba(0,0,0,0.3);
    }

    /* Position the "next button" to the right */
    .next {
      right: 0;
      border-radius: 3px 0 0 3px;
    }

    /* On hover, add a black background color with a little bit see-through */
    .prev:hover, .next:hover {
      background-color: rgba(0,0,0,0.8);
    }

    /* The dots/bullets/indicators */
    .dots {
      text-align: center;
      margin-top: 15px;
    }

    .dot {
      cursor: pointer;
      height: 13px;
      width: 13px;
      margin: 0 2px;
      background-color: #bbb;
      border-radius: 50%;
      display: inline-block;
      transition: background-color 0.6s ease;
    }

    .active, .dot:hover {
      background-color: #717171;
    }

    /* Fading animation */
    .fade {
      animation-name: fade;
      animation-duration: 1.5s;
    }

    @keyframes fade {
      from {opacity: .4} 
      to {opacity: 1}
    }

    /* Title Container with Logo, Title, and Info Card */
    #title-container {
      display: flex;
      align-items: center;
      background-color: #418FDE;
      padding: 10px 20px;
      color: white;
      margin-bottom: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      flex-wrap: wrap;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.2s;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .title-image {
      width: 220px;
      height: 90px;
      margin-right: 5px;
      border-radius: 5px;
    }

    #title {
      flex: 1;
      text-align: left;
    }

    #title h1 {
      margin: 0;
      font-size: 30px;
      font-weight: bold;
      border-bottom: 3px solid white;
      padding-bottom: 5px;
      display: inline-block;
    }

    #title h2 {
      margin: 0;
      font-size: 24px;
      font-weight: normal;
      color: #f0f0f0;
    }

    /* Consistent title styling for all sections */
    h2 {
      color: #84adec;
      font-size: 20px;
      font-weight: bold;
      text-align: left;
      border-bottom: 2px solid #418FDE;
      margin-bottom: 15px;
    }

    /* Description container styling */
    #description-container {
      display: flex;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 10px 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-family: Arial, sans-serif;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.4s;
    }

    #description-container p {
      font-size: 14px;
      line-height: 1.6;
      color: #555;
      margin-bottom: 15px;
    }

    #description-container strong { color: #333; font-weight: 600; }
    #description-container .data-point { color: #418FDE; font-weight: 600; }

    /* Dashboard Cards Styling */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.6s;
    }

    .dashboard-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 10px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      height: 100px;
      background: #fff;
      opacity: 0;
      transform: scale(0.9);
      animation: cardEntrance 0.5s ease-in-out forwards;
    }

    @keyframes cardEntrance {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .dashboard-card:hover { transform: translateY(-3px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); }

    .card-content { flex: 1; }
    .card-content h2 { margin: 0; font-size: 2em; color: #ffffff; }
    .card-content p { margin: 4px 0 0; color: #ffffff; font-size: 1em; }
    .card-image { display: flex; align-items: center; justify-content: flex-end; width: 60px; margin-left: 10px; }
    .card-icon { width: 40px; height: 40px; }

    /* Staggered delays for dashboard cards */
    .dashboard-card:nth-child(1) { animation-delay: 1s; }
    .dashboard-card:nth-child(2) { animation-delay: 2s; }
    .dashboard-card:nth-child(3) { animation-delay: 3s; }
    .dashboard-card:nth-child(4) { animation-delay: 4s; }
    .dashboard-card:nth-child(5) { animation-delay: 5s; }

    /* Parent Container for Text and Map */
    .idps-frame-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.8s;
    }

    /* Text Container for Total Number of IDPs by STATE */
    #idps-text-container {
      flex: 1;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    #idps-text-container p {
      font-size: 14px;
      line-height: 1.6;
      color: #555;
      margin-bottom: 15px;
    }

    #idps-text-container ul {
      list-style-type: disc;
      margin-left: 20px;
      color: #555;
    }

    #idps-text-container ul li {
      margin-bottom: 5px;
    }

    #idps-text-container strong {
      color: #333;
      font-weight: 600;
    }

    /* Map Container for Total Number of IDPs by STATE */
    #map-container-3 {
      flex: 2;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    #map3 {
      width: 100%;
      height: 80vh;
      border-radius: 8px;
    }

    /* Maps container styling */
    .maps-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.8s;
    }

    #map-container, #map-container-2, #map-container-4 {
      flex: 1;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    #map, #map2, #map4 {
      width: 100%;
      height: 80vh;
      border-radius: 8px;
    }

    /* Timeline container styling */
    #timeline-map-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 20px;
      min-width: 300px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 1s;
    }

    #timeline-container {
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      height: 300px;
    }

    #timelineChart {
      width: 100% !important;
      height: 250px !important;
    }

    /* Mobility in Sudan Text Container */
    #mobility-text-container {
      flex: 1;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-size: 14px;
      line-height: 1.6;
      color: #555;
    }

    #mobility-text-container h2 {
      color: #84adec;
      font-size: 20px;
      font-weight: bold;
      text-align: left;
      border-bottom: 2px solid #418FDE;
      margin-bottom: 5px;
    }

    #mobility-text-container p {
      margin-bottom: 15px;
    }

    #mobility-text-container strong {
      color: #333;
      font-weight: 600;
    }

    #mobility-text-container .data-point {
      color: #418FDE;
      font-weight: 600;
    }

    /* Pie Chart Map Showing Displacement Proportions */
    #map5 {
      height: 600px;
      border-radius: 8px;
      margin: 20px 0;
    }
    
    .legend {
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 1px 5px rgba(0,0,0,0.4);
    }

    /* Country Circle Map Styles */
    #country-circle-map {
      height: 600px;
      border-radius: 8px;
      margin: 20px 0;
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    /* Drill-down back button */
    .drilldown-back {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000;
      background: #418FDE;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      display: none;
    }

    .drilldown-back:hover {
      background: #2a6fbb;
    }
    
    /* Footer styling */
    footer {
      background-color: #418FDE;
      color: #FFFFFF;
      text-align: center;
      padding: 10px;
      margin-top: 20px;
      font-size: 12px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 1.4s;
    }

    /* Filter controls styling */
    .filter-controls {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      flex-wrap: wrap;
    }

    .filter-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .filter-group label {
      font-weight: bold;
      color: #555;
    }

    .filter-group select {
      padding: 8px 12px;
      border-radius: 4px;
      border: 1px solid #ddd;
      background: white;
    }

    /* Export buttons */
    .export-buttons {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
    }

    .export-btn {
      padding: 8px 16px;
      background: #418FDE;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .export-btn:hover {
      background: #2a6fbb;
    }

    /* Story sections for scrollytelling */
    .story-section {
      padding: 20px;
      margin-bottom: 30px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.5s, transform 0.5s;
    }

    .story-section.active {
      opacity: 1;
      transform: translateY(0);
    }

    /* Responsive design for smaller screens */
    @media (max-width: 768px) {
      #title-container { flex-direction: column; align-items: flex-start; }
      .content-container { flex-direction: column; }
      #map, #map2, #map3, #map4, #map5, #country-circle-map { height: 90vh; }

      .idps-frame-container {
        flex-direction: column;
      }

      #idps-text-container,
      #map-container-3 {
        flex: 1;
      }

      #map3 {
        height: 60vh;
      }
      
      /* Adjust slideshow for mobile */
      .slide img {
        max-height: 300px;
      }
      
      .prev, .next {
        padding: 10px;
        font-size: 16px;
      }
      
      /* Adjust loading spinner for mobile */
      .spinner {
        width: 60px;
        height: 60px;
      }
      
      .spinner-dot {
        width: 12px;
        height: 12px;
      }
      
      .loading-text {
        font-size: 16px;
      }

      .filter-controls {
        flex-direction: column;
        gap: 10px;
      }

      .filter-group {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    @media print {
      body { font-size: 12pt; color: #000; }
      .dashboard-cards, .maps-container { page-break-inside: avoid; }
      footer { display: none; }
    }
  </style>
</head>

<body>
  <!-- Loading Spinner -->
  <div id="loading-spinner">
    <div class="spinner">
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
    </div>
    <div class="loading-text">Loading Displacement Data...</div>
    <div class="loading-progress">
      <div class="loading-progress-bar" id="progress-bar"></div>
    </div>
  </div>

  <!-- Dashboard Section -->
  <div id="dashboard-section">
    <!-- Title Container with Logo, Title, and Info Card -->
    <div id="title-container">
      <div id="title">
        <h1>SUDAN | DISPLACEMENT TRACKING MATRIX - SUDAN MOBILITY</h1>
        <h2><strong>Two Years of Displacement</strong></h2>
      </div>
      <img src="./data/IOM_DTM_WHITE.png" alt="IOM Logo" class="title-image">
    </div>
    
    <!-- Slideshow Gallery -->
    <div class="slideshow-container">
      <div class="slide fade">
        <img src="./data/image5.jpg" alt="Displacement Image 4">
      </div>
      
      <div class="slide fade">
        <img src="./data/image5.jpg" alt="Displacement Image 4">
      </div>
      
      <div class="slide fade">
        <img src="./data/image1.jpg" alt="Displacement Image 6"> 
      </div>
      
      <!-- Next and previous buttons -->
      <a class="prev" onclick="plusSlides(-1)">❮</a>
      <a class="next" onclick="plusSlides(1)">❯</a>
    </div>
    
    <!-- The dots/circles -->
    <div class="dots">
      <span class="dot" onclick="currentSlide(1)"></span> 
      <span class="dot" onclick="currentSlide(2)"></span> 
      <span class="dot" onclick="currentSlide(3)"></span> 
    </div>

    <!-- Dashboard Cards Container -->
    <div class="dashboard-cards">
      <!-- Card 1: Internally Displaced Persons -->
      <div class="dashboard-card" style="background-color: #82C4FF; color: #fff;">
        <div class="card-content">
          <h2>11,585,384</h2>
          <p>Internally Displaced </p>
        </div>
        <div class="card-image">
          <img src="./data/Internally displaced.png" alt="IDP Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 2: Returnees -->
      <div class="dashboard-card" style="background-color: #82C4FF; color: #fff;">
        <div class="card-content">
          <h2>396,738</h2>
          <p>Returnees</p>
        </div>
        <div class="card-image">
          <img src="./data/Returnees.png" alt="Returnee Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 3: Crossing Border -->
      <div class="dashboard-card" style="background-color: #82C4FF; color: #fff;">
        <div class="card-content">
          <h2>3,934,086</h2>
          <p> Crossing Border</p>
        </div>
        <div class="card-image">
          <img src="./data/Crossing Border.png" alt="Border Crossing Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 4: Migrants Affected -->
      <div class="dashboard-card" style="background-color: #82C4FF; color: #fff;">
        <div class="card-content">
          <h2>400,000</h2>
          <p>Migrants Affected</p>
        </div>
        <div class="card-image">
          <img src="./data/Migrants Affected.png" alt="Migrant Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 5: Locations Covered -->
      <div class="dashboard-card" style="background-color: #82C4FF; color: #fff;">
        <div class="card-content">
          <h2>10,285</h2>
          <p>Locations Covered</p>
        </div>
        <div class="card-image">
          <img src="./data/Location.png" alt="Location Icon" class="card-icon">
        </div>
      </div>
    </div>
  </div>

  <!-- Filter Controls -->
  <div class="filter-controls">
    <div class="filter-group">
      <label for="time-filter">Time Period:</label>
      <select id="time-filter">
        <option value="all">All Time</option>
        <option value="2023">2023</option>
        <option value="2024">2024</option>
        <option value="2025">2025</option>
      </select>
    </div>
    
    <div class="filter-group">
      <label for="region-filter">Region:</label>
      <select id="region-filter">
        <option value="all">All Regions</option>
        <option value="darfur">Darfur</option>
        <option value="khartoum">Khartoum</option>
        <option value="south">South</option>
        <option value="east">East</option>
      </select>
    </div>
  </div>

  <!-- Export Controls -->
  <div class="export-buttons">
    <button class="export-btn" id="export-png">Export as PNG</button>
    <button class="export-btn" id="export-pdf">Export as PDF</button>
  </div>

  <!-- Story Sections -->
  <div class="story-section" data-viz="map3">
    <h2>Understanding the Crisis</h2>
    <p>Sudan hosts an estimated 11,301,340 internally displaced persons (IDPs) as of 30 March 2025, including those displaced both before and after the outbreak of the conflict between the Sudanese Armed Forces (SAF) and Rapid Support Forces (RSF) on 15 April 2023.</p>
    <p>This report analyses displacement pathways and key demographic information for the total population of IDPs across Sudan, as well as data on mixed cross-border movements into neighbouring countries.</p>
  </div>

  <!-- IDPs Section -->
  <div id="idps-section" class="idps-frame-container">
    <!-- Text Container for Total Number of IDPs by State -->
    <div id="idps-text-container">
      <h2>CONTEXT</h2>
      <p>
       Sudan hosts an estimated 11,301,340 internally displaced
persons (IDPs) as of 30 March 2025, including those
displaced both before and after the outbreak of the conflict
between the Sudanese Armed Forces (SAF) and Rapid
Support Forces (RSF) on 15 April 2023.This report analyses displacement pathways and key
demographic information for the total population of
IDPs across Sudan, as well as data on mixed cross-border
movements into neighbouring countries.
      </p>
      <p>
        <h3>Key insights:</h3>
        <ul>
          <li><strong style="color: #FF5733;" >30%:</strong>  of a population is displaced both internally and externally</li>
          <li><strong style="color: #FF5733;">11.3 Million </strong> people have been displaced internally across all of Sudan, highlighting a severe humanitarian crisis driven by conflict, instability, and other factors.</li>
          <li><strong style="color: #FF5733;">3.9 Million </strong> people have been displaced externally from Sudan</li>
          <li><strong style="color: #FF5733;">3.63 Million</strong>  IDPs are concentrated in South Darfur and North Darfur, underscoring the immense scale of displacement and humanitarian needs in these regions.</li>
          <li><strong style="color: #FF5733;">4 Million</strong> IDPs live in camps across Sudan</li>
          <li><strong style="color: #FF5733;">7.4 Million</strong> IDPs have been displaced from Khartoum, South Darfur, and North Darfur,</li>
        </ul>
      </p>
    </div>

    <!-- Map Container for Total Number of IDPs by State -->
    <div id="map-container-3">
      <h2 id="map-title-3">Total Number of IDPs by State</h2>
      <button id="drilldown-back" class="drilldown-back">← Back to States</button>
      <div id="map3"></div>
    </div>
  </div>
  
  <!-- Story Section -->
  <div class="story-section" data-viz="map5">
    <h2>Displacement Proportions</h2>
    <p>This visualization shows the proportion of each state's population that has been displaced by the ongoing conflict. The pie charts provide an immediate visual comparison of displacement severity across different regions.</p>
    <p>North Darfur stands out with the highest displacement proportion (66%) - nearly two-thirds of its population has been forced to flee, while South Darfur shows the largest absolute numbers despite being a smaller proportion of its larger population.</p>
  </div>

  <!-- Displacement Section -->
  <div id="displacement-section" class="maps-container">
    <div id="map-container">
      <h2>Displacement Proportions by State</h2>
      <div id="mobility-text-container">
        <p>
          This map visualizes the proportion of each state's population that has been displaced by the ongoing conflict. The pie chart markers show at a glance which states have been most severely affected, with the orange segments representing displaced populations and blue segments showing remaining residents.
        </p>
        <p>
          <strong>Key insights from the map visualization:</strong>
          <ul>
            <li><strong>North Darfur stands out</strong> with the highest displacement proportion (66%) - nearly two-thirds of its population has been forced to flee</li>
            <li><strong>South Darfur shows</strong> the largest absolute numbers (over 2 million displaced) despite being a smaller proportion (53%) of its larger population</li>
            <li><strong>Khartoum's displacement</strong> (3.5 million people) represents 38% of the state's population, visible through the relative sizes of the pie segments</li>
            <li><strong>Northern states</strong> like Northern and Red Sea show much smaller displacement proportions (1-2%), visible through their predominantly blue pie charts</li>
          </ul>
        </p>
      </div>
      <div id="map5"></div>
    </div>
  </div>
  
  <!-- Story Section -->
  <div class="story-section" data-viz="map2">
    <h2>Displacement Pathways</h2>
    <p>The flow map reveals critical displacement corridors that have emerged during the crisis. The thickest lines show the mass exodus from Khartoum to neighboring states, particularly Aj Jazirah, Sennar, and White Nile.</p>
    <p>Darfur cross-border movements into Chad and South Sudan are also clearly visible, with particularly heavy movement from West Darfur to Chad.</p>
  </div>

  <!-- Pathways Section -->
  <div id="pathways-section" id="map-container">
    <h2 id="map-title-2">IDPs Pathways Across Sudan</h2>
    <div id="mobility-text-container">
      <p>
        This map visualizes the complex movement patterns of Internally Displaced Persons (IDPs) across Sudan. The animated flow lines represent the pathways taken by displaced populations, with their thickness indicating the relative volume of movement between locations. The map reveals several critical displacement corridors that have emerged during the crisis.
      </p>
    </div>
    <div id="map2"></div>
  </div>
 
  <!-- Story Section -->
  <div class="story-section" data-viz="country-circle-map">
    <h2>Regional Impact</h2>
    <p>The displacement crisis has created significant regional challenges, with over 3.9 million Sudanese refugees now living in neighboring countries. Egypt has received the largest number (1.5 million), followed by Chad (767,365) and South Sudan (341,909).</p>
    <p>These patterns reflect both historical migration routes and geographical proximity to conflict zones, with Darfur refugees primarily going to Chad, while those from eastern Sudan flee to Ethiopia and Egypt.</p>
  </div>

  <!-- Country Circle Propagation Map -->
  <div class="maps-container">
    <div id="map-container">
      <div id="mobility-text-container">
        <h2>Displacement to Neighboring Countries</h2>
        <p>
          The map below illustrates the significant displacement of Sudanese populations to neighboring countries since the conflict began. The size of each circle represents the relative number of displaced persons in each country, with the largest flows going to Egypt, Chad, and South Sudan. This external displacement has created regional humanitarian challenges, with over 3.9 million Sudanese refugees now living in neighboring countries.
        </p>
      </div>
      <div id="country-circle-map"></div>
    </div>
  </div>

  <!-- Story Section -->
  <div class="story-section" data-viz="map4">
    <h2>Returns and Cross-Border Movements</h2>
    <p>Since December 2024, DTM teams have monitored 396,738 individuals returning to their places of origin in Sudan—a significant shift in displacement trends after nearly two years of conflict.</p>
    <p>Aj Jazirah has seen the highest proportion of returnees (66%), driven by improved access and relative stability, while returns to Khartoum remain limited (5%) due to ongoing insecurity and infrastructure damage.</p>
  </div>

  <!-- Returnees Section -->
  <div id="returnees-section" class="idps-frame-container">
    <!-- Map Container for Total Number of Returnees by State -->
    <div id="map-container-4">
      <h2 id="map-title-4">Total Number of Returnees by State</h2>
      <div id="map4"></div>
    </div>

    <!-- Text Container for Mobility in Sudan -->
    <div id="mobility-text-container">
      <h2>Returns and Cross-Border Movements</h2>
      <p>Since December 2024, DTM teams have monitored 396,738 individuals returning to their places of origin in Sudan—a significant shift in displacement trends after nearly two years of conflict between the Rapid Support Forces (RSF) and Sudanese Armed Forces (SAF).</p>
      
      <h3>Primary Return Destinations</h3>
      <ul>
        <li><strong>Aj Jazirah</strong>: 66% of returnees he highest proportion of returnees, driven by improved access and relative stability </li>
        <li><strong>Sennar</strong>: 29% of returnees</li>
        <li><strong>Khartoum</strong>: 5% of returnees Limited returns to the capital reflect ongoing insecurity, infrastructure damage, and lack of basic services.</li>
      </ul>
    </div>
  </div>

  <!-- Story Section -->
  <div class="story-section" data-viz="map">
    <h2>Returnee Pathways</h2>
    <p>The flow map shows distinct patterns in return movements, with most returnees coming from relatively safer areas like Aj Jazirah and Sennar. Many returning households are engaging in short-term visits rather than permanent resettlement, primarily to evaluate security conditions or retrieve belongings.</p>
  </div>

  <!-- Maps Container for Returnee Pathways -->
  <div class="maps-container">
    <div id="map-container-2">
      <h2 id="map-title">Returnee Pathways Across Sudan</h2>
      <div id="map"></div>
    </div>
  </div>

  <!-- Story Section -->
  <div class="story-section" data-viz="timelineChart">
    <h2>Displacement Over Time</h2>
    <p>The timeline shows the dramatic escalation of displacement following the outbreak of conflict in April 2023. The most significant spikes occurred in May 2024 when displacement surpassed 10 million, and in November 2024 when it reached over 11.3 million.</p>
    <p>The recent decline in early 2025 reflects the first signs of return movements, though the situation remains volatile.</p>
  </div>

  <!-- Timeline Section -->
  <div id="timeline-section" id="timeline-map-container">
    <!-- Timeline Graph Container -->
    <div id="timeline-container">
      <h2>Moblity Over Time (2023 - 2025)</h2>
      <canvas id="timelineChart"></canvas>
    </div>
  </div>
  
  <!-- Disclaimer paragraph -->
  <div style="background-color: #f8f9fa; border-left: 4px solid #FF671F; padding: 15px; margin: 20px 0; font-size: 14px; line-height: 1.6;">
    <p style="margin: 0; color: #555;">
      <strong>DISCLAIMER:</strong> Due to on-going insecurity, DTM collects data through a dual 
      combination of in-person and remote interviews with key informants across its network. 
      Figures should be understood as preliminary estimates and are subject to change pending 
      future verification exercises. Percentages across the report may not equal 100 per cent 
      due to rounding.
    </p>
  </div>

  <!-- Add image above the footer -->
  <img src="./data/doner.png" alt="Donor Logo" style="width: 100%; height: auto; display: block; margin: 0 auto;">

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 International Organization for Migration | IOM, UN Migration. Sudan | Displacement Tracking Matrix</p>
    <div class="footer-links">
      <a href="https://dtm.iom.int/sudan" target="_blank">Visit IOM Sudan Website</a> |
      <a href="https://displacement.iom.int/" target="_blank">DTM Global Website</a> |
    </div>
    <div class="footer-info">
      <p>For more information, please contact <a href="mailto:dtmsudan@iom.int">dtmsudan@iom.int</a>.</p>
    </div>
  </footer>

  <!-- External Scripts -->
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://unpkg.com/esri-leaflet@3.0.0/dist/esri-leaflet.js"></script>
  <script src="https://unpkg.com/@tweenjs/tween.js@18.6.4/dist/tween.umd.js"></script>
  <script src="./src/CanvasFlowmapLayer.js"></script>
  <script src="https://unpkg.com/papaparse@5.3.0/papaparse.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.10.0/mapbox-gl.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/2.1.0/chartjs-plugin-annotation.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dom-to-image@2.6.0/dist/dom-to-image.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    // Main Dashboard Controller
    class DashboardController {
      constructor() {
        this.initializedMaps = {};
        this.animationManager = new AnimationManager();
        this.dataService = new DataService();
        this.init();
      }
      
      async init() {
        this.setupLoadingScreen();
        this.setupEventListeners();
        this.setupStorySections();
        await this.initializeVisualizations();
        this.hideLoadingScreen();
      }
      
      setupLoadingScreen() {
        let progress = 0;
        const progressBar = document.getElementById('progress-bar');
        const loadingSpinner = document.getElementById('loading-spinner');
        const loadingText = document.querySelector('.loading-text');
        
        const progressInterval = setInterval(() => {
          progress += Math.random() * 10;
          if (progress >= 100) {
            progress = 100;
            clearInterval(progressInterval);
            loadingText.textContent = 'Almost there...';
          }
          progressBar.style.width = progress + '%';
        }, 200);
      }
      
      hideLoadingScreen() {
        const loadingSpinner = document.getElementById('loading-spinner');
        loadingSpinner.style.opacity = '0';
        setTimeout(() => {
          loadingSpinner.style.display = 'none';
        }, 500);
      }
      
      setupEventListeners() {
        // Slideshow controls
        document.querySelector('.prev').addEventListener('click', () => plusSlides(-1));
        document.querySelector('.next').addEventListener('click', () => plusSlides(1));
        
        // Filter controls
        document.getElementById('time-filter').addEventListener('change', (e) => {
          this.updateVisualizations({ timePeriod: e.target.value });
        });
        
        document.getElementById('region-filter').addEventListener('change', (e) => {
          this.updateVisualizations({ region: e.target.value });
        });
        
        // Export buttons
        document.getElementById('export-png').addEventListener('click', this.exportAsPNG);
        document.getElementById('export-pdf').addEventListener('click', this.exportAsPDF);
        
        // Drill-down back button
        document.getElementById('drilldown-back').addEventListener('click', () => {
          this.drillBackToStates();
        });
      }
      
      setupStorySections() {
        const sections = document.querySelectorAll('.story-section');
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersectionRatio > 0.5) {
              entry.target.classList.add('active');
              const vizId = entry.target.getAttribute('data-viz');
              if (vizId && !this.initializedMaps[vizId]) {
                this.initializeMap(vizId);
                this.initializedMaps[vizId] = true;
              }
            }
          });
        }, { threshold: [0.5] });

        sections.forEach(section => {
          observer.observe(section);
        });
      }
      
      async initializeVisualizations() {
        // Initialize timeline first as it's visible at the top
        await this.initializeTimeline();
        
        // Initialize other visualizations as they come into view
        // via the IntersectionObserver in setupStorySections
      }
      
      async initializeMap(mapId) {
        switch(mapId) {
          case 'map':
            return this.initializeReturneePathwaysMap();
          case 'map2':
            return this.initializeIDPPathwaysMap();
          case 'map3':
            return this.initializeIDPsByStateMap();
          case 'map4':
            return this.initializeReturneesByStateMap();
          case 'map5':
            return this.initializeDisplacementProportionsMap();
          case 'country-circle-map':
            return this.initializeCountryCircleMap();
        }
      }
      
      async initializeTimeline() {
        const ctx = document.getElementById('timelineChart').getContext('2d');
        
        // Color scales
        const colorScales = {
          sequential: chroma.scale(['#f7fbff','#4292c6','#08306b']).colors(5),
          diverging: chroma.scale(['#d7191c','#fdae61','#ffffbf','#abd9e9','#2c7bb6']).colors(5),
          categorical: ['#418FDE', '#FF671F', '#5CB8B2', '#FFB81C', '#D22630']
        };
        
        this.timelineChart = new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['Aug-2023', 'Sep-2023', 'Oct-2023', 'Nov-2023', 'Dec-2023', 'Jan-2024', 'Feb-2024', 'Mar-2024', 'Apr-2024', 'May-2024', 'Jun-2024', 'Jul-2024', 'Aug-2024', 'Sep-2024', 'Oct-2024', 'Nov-2024', 'Dec-2024', 'Jan-2025', 'Feb-2025', 'Mar-2025'],
            datasets: [
              {
                label: 'IDPs Over Time',
                data: [3801754, 4425083, 4856294, 5340863, 5942580, 6144363, 6397698, 6622565, 6786816, 10095054, 10540215, 10710015, 10834382, 10890722, 11018231, 11359005, 11532774,11568970,11585384,11301340],
                borderColor: colorScales.categorical[0],
                backgroundColor: colorScales.sequential[2],
                borderWidth: 3,
                fill: false,
                pointBackgroundColor: '#ffffff',
                pointBorderColor: colorScales.categorical[0],
                pointRadius: 5,
                pointHoverRadius: 7,
                tension: 0.4
              },
              {
                label: 'Returnees Over Time',
                data: [0, 0, 0, 0, 0, 0,0, 0, 0, 0, 0, 0, 0, 0, 0, 0,0, 0, 0,396738],
                borderColor: colorScales.categorical[1],
                backgroundColor: colorScales.diverging[0],
                borderWidth: 3,
                fill: false,
                pointBackgroundColor: '#ffffff',
                pointBorderColor: colorScales.categorical[1],
                pointRadius: 5,
                pointHoverRadius: 7,
                tension: 0.4
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              tooltip: {
                backgroundColor: '#0033A0',
                titleColor: '#82C4FF',
                bodyColor: '#82C4FF',
                borderColor: '#82C4FF',
                borderWidth: 1,
                displayColors: false
              },
              legend: {
                display: true
              },
              annotation: {
                annotations: {
                  conflictStart: {
                    type: 'line',
                    xMin: '15-Apr-2023',
                    xMax: '15-Apr-2023',
                    borderColor: 'red',
                    borderWidth: 2,
                    label: {
                      content: 'Conflict Begins',
                      enabled: true,
                      position: 'top'
                    }
                  }
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                title: {
                  display: true,
                  text: 'Total',
                  color: '#82C4FF',
                  font: {
                    size: 14,
                    weight: 'bold'
                  }
                },
                grid: {
                  color: '#e0e0e0'
                }
              },
              x: {
                title: {
                  display: true,
                  text: 'Month',
                  color: '#82C4FF',
                  font: {
                    size: 14,
                    weight: 'bold'
                  }
                },
                grid: {
                  color: '#e0e0e0'
                }
              }
            }
          }
        });
      }
      
      async initializeReturneePathwaysMap() {
        const map = L.map('map').setView([16, 30], L.Browser.mobile ? 3 : 5.5);
        
        // Base layers
        const mapboxCustom1 = L.tileLayer('https://api.mapbox.com/styles/v1/omerosman/cm8oy6is4006101si7ll3bs4h/tiles/{z}/{x}/{y}?access_token=pk.eyJ1Ijoib21lcm9zbWFuIiwiYSI6ImUxZDBkODBlNjQxMDE2M2Y3OTQ3MWIwNTJkMjgzZTI3In0.ekCHuxRflTOO0RpQ6rQR7Q', {
          attribution: '© <a href="https://www.mapbox.com/about/maps/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
          tileSize: 512,
          zoomOffset: -1,
          maxZoom: 18
        }).addTo(map);
        
        // Load data and create flow map
        const data = await this.dataService.getData('./data/data.csv');
        const geoJsonFeatureCollection = {
          type: 'FeatureCollection',
          features: data.map(datum => ({
            type: 'Feature',
            geometry: { type: 'Point', coordinates: [datum.s_lon, datum.s_lat] },
            properties: datum
          }))
        };

        this.flowmapLayer = L.canvasFlowmapLayer(geoJsonFeatureCollection, {
          originAndDestinationFieldIds: {
            originUniqueIdField: 's_state_id',
            originGeometry: { x: 's_lon', y: 's_lat' },
            destinationUniqueIdField: 'e_locality_id',
            destinationGeometry: { x: 'e_lon', y: 'e_lat' }
          },
          style: (feature) => {
            const baseRadius = 6;
            const maxRadius = 20;
            const volume = feature.properties.e_Volume || 0;

            const radius = feature.properties.isOrigin
              ? baseRadius
              : Math.min(baseRadius + (volume / 5000), maxRadius);

            return {
              radius: radius,
              weight: 1,
              color: feature.properties.isOrigin ? '#FFFFFF' : '#FFFFFF',
              fillColor: feature.properties.isOrigin ? '#418FDE' : 'rgb(255, 103, 31)',
              fillOpacity: feature.properties.isOrigin ? 0.8 : 0.7
            };
          },
          canvasBezierStyle: {
            type: 'classBreaks',
            field: 'e_Volume',
            classBreakInfos: [
              { classMinValue: 1, classMaxValue: 10000, symbol: { strokeStyle: '#ffb81c', lineWidth: 0.5, lineCap: 'round', shadowColor: '#fee8c8', shadowBlur: 2.0 } },
              { classMinValue: 10001, classMaxValue: 20000, symbol: { strokeStyle: '#ff671f', lineWidth: 1.5, lineCap: 'round', shadowColor: '#fdbb84', shadowBlur: 2.0 } },
              { classMinValue: 20001, classMaxValue: 200000, symbol: { strokeStyle: '#d22630', lineWidth: 3, lineCap: 'round', shadowColor: '#e34a33', shadowBlur: 2.0 } }
            ],
            defaultSymbol: { strokeStyle: '#e7e1ef', lineWidth: 0.5, lineCap: 'round', shadowColor: '#e7e1ef', shadowBlur: 1.5 }
          },
          pathDisplayMode: 'all',
          animationStarted: true,
          animationEasingFamily: 'Linear',
          animationEasingType: 'None',
          animationDuration: 3000,
          onEachFeature: (feature, layer) => {
            const tooltipContent = feature.properties.isOrigin
              ? `State of Displacement: ${feature.properties.s_State}`
              : `State of Return: ${feature.properties.e_locality}`;

            layer.bindTooltip(tooltipContent);
            
            const popupContent = feature.properties.isOrigin
              ? `<b>State of Displacement:</b> ${feature.properties.s_State}`
              : `<b>State of Return:</b> ${feature.properties.e_locality}`;

            layer.bindPopup(popupContent);
          }
        }).addTo(map);

        // Highlight paths on mouseover
        this.flowmapLayer.on('mouseover', (e) => {
          if (e.sharedOriginFeatures.length) {
            this.flowmapLayer.selectFeaturesForPathDisplay(e.sharedOriginFeatures, 'SELECTION_NEW');
          }
          if (e.sharedDestinationFeatures.length) {
            this.flowmapLayer.selectFeaturesForPathDisplay(e.sharedDestinationFeatures, 'SELECTION_NEW');
          }
        });

        // Add legend
        const legend = L.control({ position: 'bottomright' });
        legend.onAdd = () => {
          const div = L.DomUtil.create('div', 'legend');
          div.innerHTML = `
            <span style="font-size:14px">Returnee Flow Volume:</span><br/>
            <div style="width:70px;height:3px;background:#ffb81c;float:left;margin-right:10px;margin-top:10px"></div>
            <span style="float:left;font-weight:bold"> < 10000</span><br/>
            <div style="width:70px;height:4px;background:#ff671f;float:left;margin-right:10px;margin-top:10px"></div>
            <span style="float:left;font-weight:bold">10,001 - 20,000</span><br/>
            <div style="width:70px;height:7px;background:#e34a33;float:left;margin-right:10px;margin-top:10px"></div>
            <span style="float:left;font-weight:bold"> > 20,000</span><br/>
          `;
          return div;
        };
        legend.addTo(map);
      }
      
      // Similar initialization methods for other maps...
      
      updateVisualizations(filters) {
        // Update all visualizations based on filters
        if (filters.timePeriod) {
          this.updateTimelineChart(filters.timePeriod);
        }
        
        if (filters.region) {
          this.updateMapsByRegion(filters.region);
        }
      }
      
      updateTimelineChart(timePeriod) {
        // Filter timeline data based on time period
        // Then update chart
        this.timelineChart.update();
      }
      
      updateMapsByRegion(region) {
        // Filter map data based on region
        // Then update maps
      }
      
      exportAsPNG() {
        domtoimage.toPng(document.getElementById('dashboard-section'))
          .then(dataUrl => {
            const link = document.createElement('a');
            link.download = 'sudan-displacement-dashboard.png';
            link.href = dataUrl;
            link.click();
          });
      }
      
      exportAsPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        
        domtoimage.toPng(document.getElementById('dashboard-section'))
          .then(imgData => {
            doc.addImage(imgData, 'PNG', 10, 10, 190, 0);
            doc.save('sudan-displacement-dashboard.pdf');
          });
      }
      
      drillDownToState(stateName) {
        const bounds = this.getStateBounds(stateName);
        
        this.map3.flyToBounds(bounds, {
          duration: 1,
          easeLinearity: 0.25,
          padding: [50, 50]
        }).on('moveend', () => {
          this.loadDistrictData(stateName);
        });
      }
      
      drillBackToStates() {
        this.map3.removeLayer(this.districtMarkersLayer);
        this.map3.addLayer(this.stateMarkersLayer);
        this.map3.setView([16, 30], L.Browser.mobile ? 3 : 5.5);
        document.getElementById('map-title-3').textContent = 'Total Number of IDPs by State';
        document.getElementById('drilldown-back').style.display = 'none';
      }
    }

    // Supporting Classes
    class AnimationManager {
      constructor() {
        this.animations = [];
        this.setupVisibilityHandler();
      }
      
      add(animation) {
        this.animations.push(animation);
      }
      
      pauseAll() {
        this.animations.forEach(anim => anim.pause());
      }
      
      resumeAll() {
        this.animations.forEach(anim => anim.resume());
      }
      
      cleanUp() {
        this.animations.forEach(anim => anim.stop());
        this.animations = [];
      }
      
      setupVisibilityHandler() {
        document.addEventListener('visibilitychange', () => {
          if (document.hidden) {
            this.pauseAll();
          } else {
            this.resumeAll();
          }
        });
      }
    }

    class DataService {
      constructor() {
        this.cache = {};
      }
      
      async getData(url) {
        if (this.cache[url]) return this.cache[url];
        
        try {
          const response = await fetch(url);
          const text = await response.text();
          const result = await new Promise((resolve, reject) => {
            Papa.parse(text, {
              header: true,
              complete: resolve,
              error: reject
            });
          });
          
          this.cache[url] = result.data;
          return result.data;
        } catch (error) {
          console.error('Failed to load data:', error);
          throw error;
        }
      }
    }

    // Slideshow functionality
    let slideIndex = 1;
    showSlides(slideIndex);
    
    function plusSlides(n) {
      showSlides(slideIndex += n);
    }
    
    function currentSlide(n) {
      showSlides(slideIndex = n);
    }
    
    function showSlides(n) {
      let i;
      let slides = document.getElementsByClassName("slide");
      let dots = document.getElementsByClassName("dot");
      
      if (n > slides.length) {slideIndex = 1}
      if (n < 1) {slideIndex = slides.length}
      
      for (i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";
      }
      
      for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
      }
      
      slides[slideIndex-1].style.display = "block";
      dots[slideIndex-1].className += " active";
    }
    
    // Auto-advance slides every 5 seconds
    setInterval(() => {
      plusSlides(1);
    }, 5000);

    // Initialize the dashboard when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      const dashboard = new DashboardController();
    });
  </script>
</body>
</html>
