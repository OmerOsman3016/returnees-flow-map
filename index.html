<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <meta name="description" content="Sudan | Displacement Tracking Matrix-Returnees Flow" />
  <title>Sudan | Displacement Tracking Matrix - Returnees Flow</title>

  <!-- External CSS libraries -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.min.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

  <style>
    /* Loading spinner styles */
    #loading-spinner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(255, 255, 255, 0.9);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    
    .spinner {
      width: 80px;
      height: 80px;
      position: relative;
      margin-bottom: 20px;
    }
    
    .spinner-dot {
      position: absolute;
      width: 16px;
      height: 16px;
      background: #418FDE;
      border-radius: 50%;
      animation: spinner-animation 2s infinite ease-in-out;
    }
    
    .spinner-dot:nth-child(1) {
      top: 0;
      left: 32px;
      animation-delay: 0s;
    }
    
    .spinner-dot:nth-child(2) {
      top: 8px;
      left: 8px;
      animation-delay: -0.4s;
    }
    
    .spinner-dot:nth-child(3) {
      top: 32px;
      left: 0;
      animation-delay: -0.8s;
    }
    
    .spinner-dot:nth-child(4) {
      top: 56px;
      left: 8px;
      animation-delay: -1.2s;
    }
    
    .spinner-dot:nth-child(5) {
      top: 64px;
      left: 32px;
      animation-delay: -1.6s;
    }
    
    .spinner-dot:nth-child(6) {
      top: 56px;
      left: 56px;
      animation-delay: -2s;
    }
    
    .spinner-dot:nth-child(7) {
      top: 32px;
      left: 64px;
      animation-delay: -2.4s;
    }
    
    .spinner-dot:nth-child(8) {
      top: 8px;
      left: 56px;
      animation-delay: -2.8s;
    }
    
    @keyframes spinner-animation {
      0%, 100% {
        transform: scale(0.1);
        opacity: 0.5;
      }
      50% {
        transform: scale(1);
        opacity: 1;
      }
    }
    
    .loading-text {
      font-size: 18px;
      color: #418FDE;
      font-weight: bold;
      margin-top: 20px;
      text-align: center;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% {
        opacity: 0.6;
      }
      50% {
        opacity: 1;
      }
    }
    
    .loading-progress {
      width: 200px;
      height: 4px;
      background: #e0e0e0;
      border-radius: 2px;
      margin-top: 15px;
      overflow: hidden;
    }
    
    .loading-progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #418FDE, #82C4FF);
      transition: width 0.3s ease;
      border-radius: 2px;
    }

    /* General body styling */
    body {
      margin: 20px;
      padding: 0;
      font-family: Arial, sans-serif;
      background: #FFFFFF;
      scroll-behavior: smooth;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      line-height: 1.6;
      letter-spacing: 0.5px;
      font-size: 16px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      box-sizing: border-box;
      opacity: 0;
      animation: fadeIn 1.5s ease-in-out forwards;
      padding-top: 70px; /* Added padding to accommodate fixed navigation */
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    *, *::before, *::after { box-sizing: inherit; }

    a {
      color: #0033A0;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    a:hover { color: #0056b3; }

    /* Custom scrollbar */
    body::-webkit-scrollbar { width: 10px; }
    body::-webkit-scrollbar-track { background: #f1f1f1; }
    body::-webkit-scrollbar-thumb { background: #888; border-radius: 5px; }
    body::-webkit-scrollbar-thumb:hover { background: #555; }
  
    /* Slideshow container */
    .slideshow-container {
      max-width: 100%;
      position: relative;
      margin: 20px 0;
    }

    /* Slides */
    .slide {
      display: none;
      width: 100%;
      text-align: center;
    }

    .slide img {
      width: 100%;
      max-height: 500px;
      object-fit: cover;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Next & previous buttons */
    .prev, .next {
      cursor: pointer;
      position: absolute;
      top: 50%;
      width: auto;
      padding: 16px;
      margin-top: -22px;
      color: white;
      font-weight: bold;
      font-size: 18px;
      transition: 0.6s ease;
      border-radius: 0 3px 3px 0;
      background-color: rgba(0,0,0,0.3);
    }

    /* Position the "next button" to the right */
    .next {
      right: 0;
      border-radius: 3px 0 0 3px;
    }

    /* On hover, add a black background color with a little bit see-through */
    .prev:hover, .next:hover {
      background-color: rgba(0,0,0,0.8);
    }

    /* The dots/bullets/indicators */
    .dots {
      text-align: center;
      margin-top: 15px;
    }

    .dot {
      cursor: pointer;
      height: 13px;
      width: 13px;
      margin: 0 2px;
      background-color: #bbb;
      border-radius: 50%;
      display: inline-block;
      transition: background-color 0.6s ease;
    }

    .active, .dot:hover {
      background-color: #717171;
    }

    /* Fading animation */
    .fade {
      animation-name: fade;
      animation-duration: 1.5s;
    }

    @keyframes fade {
      from {opacity: .4} 
      to {opacity: 1}
    }

    /* Title Container with Logo, Title, and Info Card */
    #title-container {
      display: flex;
      align-items: center;
      background: linear-gradient(135deg, #0033A0, #418FDE, #82C4FF);
      padding: 15px 25px;
      color: white;
      margin-bottom: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
      flex-wrap: wrap;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.2s;
    }

    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .title-image {
      width: 220px;
      height: 90px;
      margin-right: 5px;
      border-radius: 5px;
    }

    #title {
      flex: 1;
      text-align: left;
    }

    #title h1 {
      margin: 0;
      font-size: 30px;
      font-weight: bold;
      border-bottom: 3px solid white;
      padding-bottom: 5px;
      display: inline-block;
      text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
    }

    #title h2 {
      margin: 0;
      font-size: 24px;
      font-weight: normal;
      color: #f0f0f0;
    }

    /* Consistent title styling for all sections */
    h2 {
      color: #0033A0;
      font-size: 22px;
      font-weight: bold;
      text-align: left;
      border-bottom: 2px solid #418FDE;
      margin-bottom: 15px;
      padding-bottom: 8px;
    }

    /* Description container styling */
    #description-container {
      display: flex;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 8px;
      padding: 10px 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      font-family: Arial, sans-serif;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.4s;
    }

    #description-container p {
      font-size: 14px;
      line-height: 1.6;
      color: #555;
      margin-bottom: 15px;
    }

    #description-container strong { color: #333; font-weight: 600; }
    #description-container .data-point { color: #418FDE; font-weight: 600; }

    /* Dashboard Cards Styling */
    .dashboard-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.6s;
    }

    .dashboard-card {
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-radius: 10px;
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
      padding: 15px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      height: 110px;
      background: linear-gradient(135deg, #418FDE, #82C4FF);
      opacity: 0;
      transform: scale(0.9);
      animation: cardEntrance 0.5s ease-in-out forwards;
    }

    @keyframes cardEntrance {
      from { opacity: 0; transform: scale(0.9); }
      to { opacity: 1; transform: scale(1); }
    }

    .dashboard-card:hover { 
      transform: translateY(-5px); 
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
    }

    .card-content { flex: 1; }
    .card-content h2 { 
      margin: 0; 
      font-size: 2.2em; 
      color: #ffffff; 
      border: none;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
    }
    .card-content p { 
      margin: 4px 0 0; 
      color: #ffffff; 
      font-size: 1.1em;
      font-weight: 500;
    }
    .card-image { 
      display: flex; 
      align-items: center; 
      justify-content: flex-end; 
      width: 60px; 
      margin-left: 10px; 
    }
    .card-icon { 
      width: 45px; 
      height: 45px;
      filter: drop-shadow(1px 1px 2px rgba(0, 0, 0, 0.2));
    }

    /* Staggered delays for dashboard cards */
    .dashboard-card:nth-child(1) { animation-delay: 1s; }
    .dashboard-card:nth-child(2) { animation-delay: 1.2s; }
    .dashboard-card:nth-child(3) { animation-delay: 1.4s; }
    .dashboard-card:nth-child(4) { animation-delay: 1.6s; }
    .dashboard-card:nth-child(5) { animation-delay: 1.8s; }

    /* Parent Container for Text and Map */
    .idps-frame-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.8s;
    }

    /* Text Container for Total Number of IDPs by STATE */
    #idps-text-container {
      flex: 1;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    #idps-text-container p {
      font-size: 15px;
      line-height: 1.6;
      color: #444;
      margin-bottom: 15px;
    }

    #idps-text-container ul {
      list-style-type: disc;
      margin-left: 20px;
      color: #444;
    }

    #idps-text-container ul li {
      margin-bottom: 8px;
    }

    #idps-text-container strong {
      color: #333;
      font-weight: 600;
    }

    /* Map Container for Total Number of IDPs by STATE */
    #map-container-3 {
      flex: 2;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    #map3 {
      width: 100%;
      height: 80vh;
      border-radius: 8px;
    }

    /* Maps container styling */
    .maps-container {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 0.8s;
    }

    #map-container, #map-container-2, #map-container-4 {
      flex: 1;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    #map, #map2, #map4 {
      width: 100%;
      height: 80vh;
      border-radius: 8px;
    }

    /* Mobility in Sudan Text Container */
    #mobility-text-container {
      flex: 1;
      background-color: #ffffff;
      border: 1px solid #d9e0f1;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      font-size: 15px;
      line-height: 1.6;
      color: #444;
    }

    #mobility-text-container h2 {
      color: #0033A0;
      font-size: 22px;
      font-weight: bold;
      text-align: left;
      border-bottom: 2px solid #418FDE;
      margin-bottom: 15px;
      padding-bottom: 8px;
    }

    #mobility-text-container p {
      margin-bottom: 15px;
    }

    #mobility-text-container strong {
      color: #333;
      font-weight: 600;
    }

    #mobility-text-container .data-point {
      color: #418FDE;
      font-weight: 600;
    }

    /* Pie Chart Map Showing Displacement Proportions */
    #map5 {
      height: 600px;
      border-radius: 8px;
      margin: 20px 0;
    }
    
    .legend {
      background: white;
      padding: 10px;
      border-radius: 5px;
      box-shadow: 0 1px 5px rgba(0,0,0,0.4);
    }

    /* Country Circle Map Styles */
    #country-circle-map {
      height: 600px;
      border-radius: 8px;
      margin: 20px 0;
      margin-top: 20px;
      display: flex;
      flex-direction: column;
      gap: 30px;
    }

    /* Drill-down back button */
    .drilldown-back {
      position: absolute;
      top: 10px;
      left: 10px;
      z-index: 1000;
      background: #418FDE;
      color: white;
      border: none;
      padding: 5px 10px;
      border-radius: 4px;
      cursor: pointer;
      display: none;
    }

    .drilldown-back:hover {
      background: #2a6fbb;
    }

    /* Heatmap controls styling */
    .heatmap-control-button {
      background-color: #418FDE;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background-color 0.3s;
    }

    .heatmap-control-button:hover {
      background-color: #2a6fbb;
    }

    #heatmap-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 15px;
    }

    #heatmap-slider {
      flex-grow: 1;
      margin: 0 15px;
    }

    #heatmap-time-display {
      min-width: 80px;
      text-align: center;
    }
    
    /* Footer styling */
    footer {
      background: linear-gradient(135deg, #0033A0, #418FDE);
      color: #FFFFFF;
      text-align: center;
      padding: 15px;
      margin-top: 30px;
      font-size: 14px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
      opacity: 0;
      transform: translateY(20px);
      animation: slideUp 0.8s ease-in-out forwards;
      animation-delay: 1.4s;
    }

    /* Responsive design for smaller screens */
    @media (max-width: 768px) {
      #title-container { flex-direction: column; align-items: flex-start; }
      .content-container { flex-direction: column; }
      #map, #map2, #map3, #map4, #map5, #country-circle-map { height: 90vh; }

      .idps-frame-container {
        flex-direction: column;
      }

      #idps-text-container,
      #map-container-3 {
        flex: 1;
      }

      #map3 {
        height: 60vh;
      }
      
      /* Adjust slideshow for mobile */
      .slide img {
        max-height: 300px;
      }
      
      .prev, .next {
        padding: 10px;
        font-size: 16px;
      }
      
      /* Adjust loading spinner for mobile */
      .spinner {
        width: 60px;
        height: 60px;
      }
      
      .spinner-dot {
        width: 12px;
        height: 12px;
      }
      
      .loading-text {
        font-size: 16px;
      }

      /* Adjust heatmap controls for mobile */
      #heatmap-controls {
        flex-direction: column;
        align-items: stretch;
      }

      #heatmap-slider {
        width: 100%;
        margin: 10px 0;
      }

      #heatmap-time-display {
        margin: 5px 0;
      }
      
      /* Adjust navigation for mobile */
      #main-nav {
        padding: 5px;
      }
      
      #main-nav .nav-container {
        padding: 0 10px;
      }
      
      #mobile-menu-toggle {
        display: block;
      }
      
      #nav-links {
        display: none;
        width: 100%;
        text-align: center;
        padding: 0;
      }
      
      #nav-links.show {
        display: flex;
        flex-direction: column;
        background-color: rgba(0, 51, 160, 0.95);
        position: absolute;
        top: 100%;
        left: 0;
        width: 100%;
        z-index: 1000;
        box-shadow: 0 5px 10px rgba(0,0,0,0.2);
        border-radius: 0 0 10px 10px;
      }
      
      #nav-links.show li {
        margin: 0;
        width: 100%;
      }
      
      #nav-links.show li a {
        padding: 15px;
        width: 100%;
        border-bottom: 1px solid rgba(255,255,255,0.1);
      }
      
      #nav-links.show li:last-child a {
        border-bottom: none;
      }
      
      .section-preview {
        display: none;
      }
    }

    @media print {
      body { font-size: 12pt; color: #000; }
      .dashboard-cards, .maps-container { page-break-inside: avoid; }
      footer { display: none; }
      #main-nav { display: none; }
      #back-to-top { display: none; }
    }
    
    /* Enhanced Navigation Styles */
    #main-nav {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: linear-gradient(135deg, #0033A0, #418FDE);
      color: white;
      z-index: 1000;
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
      transition: all 0.3s ease;
    }
    
    #main-nav .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 20px;
      max-width: 1400px;
      margin: 0 auto;
    }
    
    #main-nav.scrolled {
      padding: 0;
      background: linear-gradient(135deg, rgba(0, 51, 160, 0.95), rgba(65, 143, 222, 0.95));
    }
    
    #nav-brand {
      display: flex;
      align-items: center;
    }
    
    #nav-brand img {
      height: 40px;
      margin-right: 10px;
    }
    
    #nav-brand span {
      font-weight: bold;
      font-size: 18px;
      white-space: nowrap;
    }
    
    #nav-links {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    
    #nav-links li {
      position: relative;
      margin: 0 2px;
    }
    
    #nav-links li a {
      display: block;
      color: white;
      text-decoration: none;
      padding: 15px 15px;
      font-weight: 500;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
      position: relative;
    }
    
    #nav-links li a:hover,
    #nav-links li a.active {
      background-color: rgba(255,255,255,0.15);
      border-bottom: 3px solid white;
    }
    
    #nav-links li a.active::after {
      content: '';
      position: absolute;
      bottom: -3px;
      left: 50%;
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 6px solid transparent;
      border-right: 6px solid transparent;
      border-bottom: 6px solid white;
    }
    
    #nav-links li a i {
      margin-right: 5px;
    }
    
    #mobile-menu-toggle {
      display: none;
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      padding: 10px;
    }
    
    /* Section preview on hover */
    .section-preview {
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
      padding: 10px;
      z-index: 1001;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      pointer-events: none;
    }
    
    #nav-links li:hover .section-preview {
      opacity: 1;
      visibility: visible;
      top: calc(100% + 5px);
    }
    
    .section-preview h4 {
      color: #0033A0;
      margin: 0 0 5px 0;
      font-size: 14px;
      border-bottom: 1px solid #eee;
      padding-bottom: 5px;
    }
    
    .section-preview p {
      color: #555;
      font-size: 12px;
      margin: 0;
    }
    
    .section-preview img {
      width: 100%;
      height: 80px;
      object-fit: cover;
      border-radius: 4px;
      margin-top: 5px;
    }
    
    /* Progress indicator for navigation */
    .progress-container {
      width: 100%;
      height: 4px;
      background: rgba(255,255,255,0.2);
      position: absolute;
      bottom: 0;
      left: 0;
    }
    
    .progress-bar {
      height: 4px;
      background: white;
      width: 0%;
      transition: width 0.3s ease;
    }
    
    /* Section highlighting */
    section {
      scroll-margin-top: 70px; /* Ensures sections don't get hidden under the fixed nav */
      padding: 20px 0;
      position: relative;
    }
    
    /* Section indicator */
    .section-indicator {
      position: absolute;
      left: -30px;
      top: 50%;
      transform: translateY(-50%);
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background-color: #418FDE;
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    section.active .section-indicator {
      opacity: 1;
    }
    
    /* Back to top button */
    #back-to-top {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: linear-gradient(135deg, #0033A0, #418FDE);
      color: white;
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      text-align: center;
      line-height: 50px;
      font-size: 20px;
      cursor: pointer;
      opacity: 0;
      transition: all 0.3s ease;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      z-index: 999;
    }
    
    #back-to-top:hover {
      background: linear-gradient(135deg, #002580, #3070B0);
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.4);
    }
    
    #back-to-top.show {
      opacity: 1;
    }
    
    /* Table of contents sidebar */
    #toc-sidebar {
      position: fixed;
      top: 70px;
      left: -250px;
      width: 250px;
      height: calc(100vh - 70px);
      background-color: white;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      z-index: 998;
      overflow-y: auto;
      padding: 20px;
    }
    
    #toc-sidebar.show {
      left: 0;
    }
    
    #toc-toggle {
      position: fixed;
      top: 80px;
      left: 20px;
      background: linear-gradient(135deg, #0033A0, #418FDE);
      color: white;
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      text-align: center;
      line-height: 40px;
      font-size: 18px;
      cursor: pointer;
      z-index: 999;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    #toc-toggle:hover {
      background: linear-gradient(135deg, #002580, #3070B0);
    }
    
    #toc-sidebar h3 {
      color: #0033A0;
      margin-top: 0;
      border-bottom: 2px solid #418FDE;
      padding-bottom: 10px;
    }
    
    #toc-sidebar ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    #toc-sidebar ul li {
      margin-bottom: 5px;
    }
    
    #toc-sidebar ul li a {
      display: block;
      padding: 8px 10px;
      color: #444;
      text-decoration: none;
      border-radius: 4px;
      transition: all 0.2s ease;
    }
    
    #toc-sidebar ul li a:hover {
      background-color: #f0f5ff;
      color: #0033A0;
    }
    
    #toc-sidebar ul li a.active {
      background-color: #418FDE;
      color: white;
    }
    
    #toc-sidebar ul li ul {
      padding-left: 20px;
      margin-top: 5px;
    }
    
    #toc-sidebar ul li ul li a {
      padding: 5px 10px;
      font-size: 14px;
    }
    
    /* Search bar in navigation */
    #nav-search {
      display: flex;
      align-items: center;
      margin-left: 20px;
    }
    
    #search-input {
      background-color: rgba(255,255,255,0.15);
      border: none;
      border-radius: 20px;
      padding: 8px 15px;
      color: white;
      width: 200px;
      transition: all 0.3s ease;
    }
    
    #search-input::placeholder {
      color: rgba(255,255,255,0.7);
    }
    
    #search-input:focus {
      background-color: rgba(255,255,255,0.25);
      outline: none;
      width: 250px;
    }
    
    #search-button {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      margin-left: -30px;
    }
    
    /* Section navigation buttons */
    .section-nav {
      display: flex;
      justify-content: space-between;
      margin: 30px 0;
    }
    
    .section-nav-button {
      display: flex;
      align-items: center;
      background: linear-gradient(135deg, #0033A0, #418FDE);
      color: white;
      border: none;
      border-radius: 30px;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .section-nav-button:hover {
      background: linear-gradient(135deg, #002580, #3070B0);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    
    .section-nav-button.prev i {
      margin-right: 10px;
    }
    
    .section-nav-button.next i {
      margin-left: 10px;
    }
    
    /* Tooltip styles */
    .tooltip {
      position: relative;
    }
    
    .tooltip .tooltip-text {
      visibility: hidden;
      width: 200px;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 6px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
      font-size: 14px;
      pointer-events: none;
    }
    
    .tooltip .tooltip-text::after {
      content: "";
      position: absolute;
      top: 100%;
      left: 50%;
      margin-left: -5px;
      border-width: 5px;
      border-style: solid;
      border-color: #333 transparent transparent transparent;
    }
    
    .tooltip:hover .tooltip-text {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>

<body>
  <!-- Enhanced Navigation Bar -->
  <nav id="main-nav">
    <div class="nav-container">
      <div id="nav-brand">
        <img src="./data/IOM_DTM_WHITE.png" alt="IOM Logo" onerror="this.src='https://via.placeholder.com/40x40?text=IOM'">
        <span>SUDAN MOBILITY TRACKER</span>
      </div>
      
      <button id="mobile-menu-toggle">☰</button>
      
      <ul id="nav-links">
        <li>
          <a href="#dashboard-section" class="nav-link active tooltip">
            <i class="fas fa-chart-pie"></i> Dashboard
            <span class="tooltip-text">Key statistics and overview</span>
          </a>
          <div class="section-preview">
            <h4>Dashboard Overview</h4>
            <p>Key statistics on displacement in Sudan</p>
            <img src="./data/image5.jpg" alt="Dashboard Preview" onerror="this.src='https://via.placeholder.com/300x80?text=Dashboard'">
          </div>
        </li>
        <li>
          <a href="#heatmap-section" class="nav-link tooltip">
            <i class="fas fa-fire"></i> Mobility Trends
            <span class="tooltip-text">Temporal analysis of displacement</span>
          </a>
          <div class="section-preview">
            <h4>Mobility Over Time</h4>
            <p>Interactive heatmap showing displacement trends</p>
            <img src="./data/image5.jpg" alt="Heatmap Preview" onerror="this.src='https://via.placeholder.com/300x80?text=Heatmap'">
          </div>
        </li>
        <li>
          <a href="#idps-section" class="nav-link tooltip">
            <i class="fas fa-users"></i> IDP Context
            <span class="tooltip-text">Background and key facts</span>
          </a>
          <div class="section-preview">
            <h4>IDP Context</h4>
            <p>Background information and key statistics</p>
            <img src="./data/image5.jpg" alt="IDP Context Preview" onerror="this.src='https://via.placeholder.com/300x80?text=IDP+Context'">
          </div>
        </li>
        <li>
          <a href="#displacement-section" class="nav-link tooltip">
            <i class="fas fa-map-marked-alt"></i> Displacement Map
            <span class="tooltip-text">Geographic distribution of displacement</span>
          </a>
          <div class="section-preview">
            <h4>Displacement Proportions</h4>
            <p>Map visualization of displacement by state</p>
            <img src="./data/image5.jpg" alt="Displacement Map Preview" onerror="this.src='https://via.placeholder.com/300x80?text=Displacement+Map'">
          </div>
        </li>
        <li>
          <a href="#pathways-section" class="nav-link tooltip">
            <i class="fas fa-route"></i> Migration Routes
            <span class="tooltip-text">Displacement pathways analysis</span>
          </a>
          <div class="section-preview">
            <h4>Displacement Pathways</h4>
            <p>Analysis of migration routes and patterns</p>
            <img src="./data/image5.jpg" alt="Pathways Preview" onerror="this.src='https://via.placeholder.com/300x80?text=Migration+Routes'">
          </div>
        </li>
      </ul>
      
      <div id="nav-search">
        <input type="text" id="search-input" placeholder="Search report...">
        <button id="search-button"><i class="fas fa-search"></i></button>
      </div>
    </div>
    <div class="progress-container">
      <div class="progress-bar" id="scroll-progress"></div>
    </div>
  </nav>

  <!-- Table of Contents Sidebar -->
  <button id="toc-toggle"><i class="fas fa-list"></i></button>
  <div id="toc-sidebar">
    <h3>Table of Contents</h3>
    <ul>
      <li><a href="#dashboard-section" class="toc-link">Dashboard</a>
        <ul>
          <li><a href="#title-container" class="toc-link">Overview</a></li>
          <li><a href="#dashboard-cards" class="toc-link">Key Statistics</a></li>
        </ul>
      </li>
      <li><a href="#heatmap-section" class="toc-link">Mobility Over Time</a>
        <ul>
          <li><a href="#heatmapChart" class="toc-link">Temporal Heatmap</a></li>
          <li><a href="#heatmap-controls" class="toc-link">Timeline Controls</a></li>
        </ul>
      </li>
      <li><a href="#idps-section" class="toc-link">IDP Context</a>
        <ul>
          <li><a href="#idps-text-container" class="toc-link">Background</a></li>
          <li><a href="#map-container-3" class="toc-link">IDP Distribution Map</a></li>
        </ul>
      </li>
      <li><a href="#displacement-section" class="toc-link">Displacement Proportions</a>
        <ul>
          <li><a href="#mobility-text-container" class="toc-link">Analysis</a></li>
          <li><a href="#map5" class="toc-link">Proportional Map</a></li>
        </ul>
      </li>
      <li><a href="#pathways-section" class="toc-link">Displacement Pathways</a></li>
    </ul>
  </div>

  <!-- Back to Top Button -->
  <button id="back-to-top" title="Back to Top"><i class="fas fa-arrow-up"></i></button>

  <!-- Loading Spinner -->
  <div id="loading-spinner">
    <div class="spinner">
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
      <div class="spinner-dot"></div>
    </div>
    <div class="loading-text">Loading Displacement Data...</div>
    <div class="loading-progress">
      <div class="loading-progress-bar" id="progress-bar"></div>
    </div>
  </div>

  <!-- Dashboard Section -->
  <section id="dashboard-section">
    <div class="section-indicator"></div>
    <!-- Title Container with Logo, Title, and Info Card -->
    <div id="title-container">
      <div id="title">
        <h1>SUDAN | DISPLACEMENT TRACKING MATRIX - SUDAN MOBILITY</h1>
        <h2><strong>Two Years of Displacement</strong></h2>
      </div>
      <!-- Add this image element to the right side of the title -->
      <img src="./data/IOM_DTM_WHITE.png" alt="IOM Logo" class="title-image">
    </div>
    
    <!-- Slideshow Gallery -->
    <div class="slideshow-container">
      <div class="slide fade">
        <img src="./data/image5.jpg" alt="Displacement Image 4">
      </div>
      
      <div class="slide fade">
        <img src="./data/image5.jpg" alt="Displacement Image 4">
      </div>
      
      <div class="slide fade">
        <img src="./data/image5.jpg" alt="Displacement Image 6"> 
      </div>
      
      <!-- Next and previous buttons -->
      <a class="prev" onclick="plusSlides(-1)">❮</a>
      <a class="next" onclick="plusSlides(1)">❯</a>
    </div>
    
    <!-- The dots/circles -->
    <div class="dots">
      <span class="dot" onclick="currentSlide(1)"></span> 
      <span class="dot" onclick="currentSlide(2)"></span> 
      <span class="dot" onclick="currentSlide(3)"></span> 
    </div>

    <!-- Dashboard Cards Container -->
    <div class="dashboard-cards" id="dashboard-cards">
      <!-- Card 1: Internally Displaced Persons -->
      <div class="dashboard-card">
        <div class="card-content">
          <h2>11,301,340</h2>
          <p>Internally Displaced </p>
        </div>
        <div class="card-image">
          <img src="./data/Internally displaced.png" alt="IDP Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 2: Returnees -->
      <div class="dashboard-card">
        <div class="card-content">
          <h2>396,738</h2>
          <p>Returnees</p>
        </div>
        <div class="card-image">
          <img src="./data/Returnees.png" alt="Returnee Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 3: Crossing Border -->
      <div class="dashboard-card">
        <div class="card-content">
          <h2>3,934,086</h2>
          <p> Crossing Border</p>
        </div>
        <div class="card-image">
          <img src="./data/Crossing Border.png" alt="Border Crossing Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 4: Migrants Affected -->
      <div class="dashboard-card">
        <div class="card-content">
          <h2>400,000</h2>
          <p>Migrants Affected</p>
        </div>
        <div class="card-image">
          <img src="./data/Migrants Affected.png" alt="Migrant Icon" class="card-icon">
        </div>
      </div>

      <!-- Card 5: Locations Covered -->
      <div class="dashboard-card">
        <div class="card-content">
          <h2>10,285</h2>
          <p>Locations Covered</p>
        </div>
        <div class="card-image">
          <img src="./data/Location.png" alt="Location Icon" class="card-icon">
        </div>
      </div>
    </div>
    
    <!-- Section Navigation -->
    <div class="section-nav">
      <button class="section-nav-button next" onclick="scrollToSection('heatmap-section')">
        Next: Mobility Trends <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </section>
  
  <!-- Heatmap Section -->
  <section id="heatmap-section" class="maps-container">
    <div class="section-indicator"></div>
    <div id="heatmap-container">
      <h2><i class="fas fa-fire"></i> Moblity Over Time (2023 - 2025)</h2>
      <div id="mobility-text-container">
        <p>
          This interactive heatmap visualization shows the progression of displacement over time. The heat intensity represents the number of displaced persons, with darker colors indicating higher numbers. Use the time slider or play button to see how the situation evolved month by month.
        </p>
        <p>
          <strong>Key patterns to observe:</strong>
          <ul>
            <li>The rapid increase in IDPs (blue line) in the first months of the conflict</li>
            <li>The sudden spike in May 2024 when displacement surpassed 10 million</li>
            <li>The appearance of returnees (orange line) only in the most recent data</li>
          </ul>
        </p>
        <div id="heatmapChart" style="height: 400px;"></div>
      <div id="heatmap-controls" style="margin-top: 20px;">
        <button id="heatmap-play-button" class="heatmap-control-button"><i class="fas fa-play"></i> Play</button>
        <input type="range" id="heatmap-slider" min="0" max="19" value="0" step="1" style="width: 70%; margin: 0 15px;">
        <span id="heatmap-time-display" style="font-weight: bold; color: #418FDE;">Aug-2023</span>
        <button id="heatmap-export-button" class="heatmap-control-button"><i class="fas fa-download"></i> Export as Image</button>
      </div>
    </div>
    </div>
    
    <!-- Section Navigation -->
    <div class="section-nav">
      <button class="section-nav-button prev" onclick="scrollToSection('dashboard-section')">
        <i class="fas fa-arrow-left"></i> Previous: Dashboard
      </button>
      <button class="section-nav-button next" onclick="scrollToSection('idps-section')">
        Next: IDP Context <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </section>

  <!-- IDPs Section -->
  <section id="idps-section" class="idps-frame-container">
    <div class="section-indicator"></div>
    <!-- Text Container for Total Number of IDPs by State -->
    <div id="idps-text-container">
      <h2><i class="fas fa-users"></i> CONTEXT</h2>
      <p>
       Sudan hosts an estimated 11,301,340 internally displaced
    persons (IDPs) as of 30 March 2025, including those
    displaced both before and after the outbreak of the conflict
    between the Sudanese Armed Forces (SAF) and Rapid
    Support Forces (RSF) on 15 April 2023.This report analyses displacement pathways and key
    demographic information for the total population of
    IDPs across Sudan, as well as data on mixed cross-border
    movements into neighbouring countries.
      </p>
      <p>
        <h3>KEY FACTS AND FIGURES:</h3>
        <ul>
          <li><strong style="color: #FF5733;" >30%:</strong>  of a population is displaced both internally and externally</li>
          <li><strong style="color: #FF5733;">11.3 Million </strong> people have been displaced internally across all of Sudan, highlighting a severe humanitarian crisis driven by conflict, instability, and other factors.</li>
          <li><strong style="color: #FF5733;">3.9 Million </strong> people have been displaced externally from Sudan</li>
          <li><strong style="color: #FF5733;">3.63 Million</strong>  IDPs are concentrated in South Darfur and North Darfur, underscoring the immense scale of displacement and humanitarian needs in these regions.</li>
          <li><strong style="color: #FF5733;">4 Million</strong> IDPs live in camps across Sudan</li>
          <li><strong style="color: #FF5733;">7.4 Million</strong> IDPs have been displaced from Khartoum, South Darfur, and North Darfur,</li>
        </ul>
      </p>
    </div>

    <!-- Map Container for Total Number of IDPs by State -->
    <div id="map-container-3">
      <h2 id="map-title-3"><i class="fas fa-map-marked-alt"></i> Total Number of IDPs by State</h2>
      <button id="drilldown-back" class="drilldown-back"><i class="fas fa-arrow-left"></i> Back to States</button>
      <div id="map3"></div>
    </div>
    
    <!-- Section Navigation -->
    <div class="section-nav">
      <button class="section-nav-button prev" onclick="scrollToSection('heatmap-section')">
        <i class="fas fa-arrow-left"></i> Previous: Mobility Trends
      </button>
      <button class="section-nav-button next" onclick="scrollToSection('displacement-section')">
        Next: Displacement Map <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </section>
  
  <!-- Displacement Section -->
  <section id="displacement-section" class="maps-container">
    <div class="section-indicator"></div>
    <div id="map-container">
      <h2><i class="fas fa-chart-pie"></i> Displacement Proportions by State</h2>
      <div id="mobility-text-container">
        <p>
          This map visualizes the proportion of each state's population that has been displaced by the ongoing conflict. The pie chart markers show at a glance which states have been most severely affected, with the orange segments representing displaced populations and blue segments showing remaining residents.
        </p>
        <p>
          <strong>Key insights from the map visualization:</strong>
          <ul>
            <li><strong>North Darfur stands out</strong> with the highest displacement proportion (66%) - nearly two-thirds of its population has been forced to flee</li>
            <li><strong>South Darfur shows</strong> the largest absolute numbers (over 2 million displaced) despite being a smaller proportion (53%) of its larger population</li>
            <li><strong>Khartoum's displacement</strong> (3.5 million people) represents 38% of the state's population, visible through the relative sizes of the pie segments</li>
            <li><strong>Northern states</strong> like Northern and Red Sea show much smaller displacement proportions (1-2%), visible through their predominantly blue pie charts</li>
          </ul>
        </p>
        <p>
          <strong>How to interpret the map symbols:</strong>
          <ul>
            <li>Each pie chart is scaled to the state's total population size</li>
            <li>Orange segments show displaced populations</li>
            <li>Blue segments show non-displaced populations</li>
            <li>The percentage label in each pie shows the exact displacement proportion</li>
            <li>Larger pies indicate states with bigger total populations</li>
          </ul>
        </p>
        <p>
          The spatial distribution reveals clear patterns - states in Darfur and Khartoum show the most severe displacement, while northern and eastern states have been less affected. This visualization helps humanitarian actors quickly identify where needs are greatest and how displacement is impacting different regions proportionally.
        </p>
        <p>
          <strong>Map interaction tips:</strong>
          <ul>
            <li>Click on any pie chart to see detailed state statistics</li>
            <li>Compare states by both segment size (proportion) and overall pie size (total population)</li>
            <li>Note the concentration of large orange segments in western Sudan</li>
          </ul>
        </p>
      </div>
      <div id="map5"></div>
    </div>
    
    <!-- Section Navigation -->
    <div class="section-nav">
      <button class="section-nav-button prev" onclick="scrollToSection('idps-section')">
        <i class="fas fa-arrow-left"></i> Previous: IDP Context
      </button>
      <button class="section-nav-button next" onclick="scrollToSection('pathways-section')">
        Next: Migration Routes <i class="fas fa-arrow-right"></i>
      </button>
    </div>
  </section>
  
  <!-- Pathways Section -->
  <section id="pathways-section">
    <div class="section-indicator"></div>
    <h2><i class="fas fa-route"></i> Displacement Pathways</h2>
    <!-- Content for pathways section -->
    <div id="mobility-text-container">
      <p>
        This section analyzes the primary displacement pathways and migration routes observed across Sudan and into neighboring countries. The visualization shows the direction and volume of population movements, highlighting the main corridors of displacement.
      </p>
      <p>
        <strong>Key migration corridors:</strong>
        <ul>
          <li>Khartoum to South Darfur (1.2 million people)</li>
          <li>North Darfur to Chad (850,000 people)</li>
          <li>Blue Nile to South Sudan (420,000 people)</li>
          <li>Khartoum to Egypt (1.1 million people)</li>
        </ul>
      </p>
    </div>
    
    <!-- Section Navigation -->
    <div class="section-nav">
      <button class="section-nav-button prev" onclick="scrollToSection('displacement-section')">
        <i class="fas fa-arrow-left"></i> Previous: Displacement Map
      </button>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p>© 2025 International Organization for Migration (IOM) - Displacement Tracking Matrix (DTM)</p>
    <p><i class="fas fa-envelope"></i> dtmsudan@iom.int | <i class="fas fa-globe"></i> displacement.iom.int/sudan</p>
  </footer>

  <!-- JavaScript for Enhanced Navigation -->
  <script>
    // Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Get all sections for scroll tracking
      const sections = document.querySelectorAll('section');
      const navLinks = document.querySelectorAll('.nav-link');
      const tocLinks = document.querySelectorAll('.toc-link');
      const progressBar = document.getElementById('scroll-progress');
      const backToTopButton = document.getElementById('back-to-top');
      const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
      const navLinksContainer = document.getElementById('nav-links');
      const mainNav = document.getElementById('main-nav');
      const tocToggle = document.getElementById('toc-toggle');
      const tocSidebar = document.getElementById('toc-sidebar');
      const searchInput = document.getElementById('search-input');
      const searchButton = document.getElementById('search-button');
      
      // Mobile menu toggle
      mobileMenuToggle.addEventListener('click', function() {
        navLinksContainer.classList.toggle('show');
      });
      
      // TOC sidebar toggle
      tocToggle.addEventListener('click', function() {
        tocSidebar.classList.toggle('show');
      });
      
      // Close mobile menu when a link is clicked
      navLinks.forEach(link => {
        link.addEventListener('click', function() {
          navLinksContainer.classList.remove('show');
        });
      });
      
      // Close TOC sidebar when a link is clicked
      tocLinks.forEach(link => {
        link.addEventListener('click', function() {
          tocSidebar.classList.remove('show');
        });
      });
      
      // Function to update active navigation link based on scroll position
      function updateActiveNavLink() {
        let currentSection = '';
        
        sections.forEach(section => {
          const sectionTop = section.offsetTop;
          const sectionHeight = section.clientHeight;
          
          if (window.pageYOffset >= (sectionTop - 100)) {
            currentSection = section.getAttribute('id');
            section.classList.add('active');
          } else {
            section.classList.remove('active');
          }
        });
        
        navLinks.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href') === `#${currentSection}`) {
            link.classList.add('active');
          }
        });
        
        tocLinks.forEach(link => {
          link.classList.remove('active');
          if (link.getAttribute('href') === `#${currentSection}`) {
            link.classList.add('active');
          }
        });
      }
      
      // Function to update scroll progress bar
      function updateScrollProgress() {
        const scrollPosition = window.scrollY;
        const totalHeight = document.body.scrollHeight - window.innerHeight;
        const scrollPercentage = (scrollPosition / totalHeight) * 100;
        
        progressBar.style.width = scrollPercentage + '%';
        
        // Show back to top button when scrolled down
        if (scrollPosition > 300) {
          backToTopButton.classList.add('show');
        } else {
          backToTopButton.classList.remove('show');
        }
        
        // Add scrolled class to nav for compact styling
        if (scrollPosition > 50) {
          mainNav.classList.add('scrolled');
        } else {
          mainNav.classList.remove('scrolled');
        }
      }
      
      // Back to top button functionality
      backToTopButton.addEventListener('click', function() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth'
        });
      });
      
      // Smooth scrolling for navigation links
      navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          const targetId = this.getAttribute('href');
          const targetSection = document.querySelector(targetId);
          
          window.scrollTo({
            top: targetSection.offsetTop - 60,
            behavior: 'smooth'
          });
        });
      });
      
      // Smooth scrolling for TOC links
      tocLinks.forEach(link => {
        link.addEventListener('click', function(e) {
          e.preventDefault();
          
          const targetId = this.getAttribute('href');
          const targetSection = document.querySelector(targetId);
          
          window.scrollTo({
            top: targetSection.offsetTop - 60,
            behavior: 'smooth'
          });
        });
      });
      
      // Function to scroll to a specific section
      window.scrollToSection = function(sectionId) {
        const targetSection = document.getElementById(sectionId);
        
        window.scrollTo({
          top: targetSection.offsetTop - 60,
          behavior: 'smooth'
        });
      };
      
      // Search functionality
      searchButton.addEventListener('click', function() {
        performSearch();
      });
      
      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          performSearch();
        }
      });
      
      function performSearch() {
        const searchTerm = searchInput.value.toLowerCase();
        
        if (searchTerm.trim() === '') {
          return;
        }
        
        // Simple search implementation - find first section containing the search term
        let found = false;
        
        sections.forEach(section => {
          if (!found && section.innerText.toLowerCase().includes(searchTerm)) {
            window.scrollTo({
              top: section.offsetTop - 60,
              behavior: 'smooth'
            });
            found = true;
            
            // Highlight the search term (simplified implementation)
            setTimeout(() => {
              alert(`Found "${searchTerm}" in the ${section.id.replace('-', ' ')} section`);
            }, 1000);
          }
        });
        
        if (!found) {
          alert(`No results found for "${searchTerm}"`);
        }
      }
      
      // Add scroll event listeners
      window.addEventListener('scroll', function() {
        updateActiveNavLink();
        updateScrollProgress();
      });
      
      // Initialize on page load
      updateActiveNavLink();
      updateScrollProgress();
      
      // Simulate loading progress
      const progressBar = document.getElementById('progress-bar');
      const loadingSpinner = document.getElementById('loading-spinner');
      
      let progress = 0;
      const loadingInterval = setInterval(function() {
        progress += Math.random() * 10;
        if (progress >= 100) {
          progress = 100;
          clearInterval(loadingInterval);
          
          // Hide loading spinner after a short delay
          setTimeout(function() {
            loadingSpinner.style.opacity = 0;
            setTimeout(function() {
              loadingSpinner.style.display = 'none';
            }, 500);
          }, 500);
        }
        progressBar.style.width = progress + '%';
      }, 200);
      
      // Slideshow functionality
      let slideIndex = 1;
      showSlides(slideIndex);
      
      // Auto advance slides
      setInterval(function() {
        plusSlides(1);
      }, 5000);
      
      // Next/previous controls
      window.plusSlides = function(n) {
        showSlides(slideIndex += n);
      }
      
      // Thumbnail image controls
      window.currentSlide = function(n) {
        showSlides(slideIndex = n);
      }
      
      function showSlides(n) {
        let i;
        let slides = document.getElementsByClassName("slide");
        let dots = document.getElementsByClassName("dot");
        
        if (n > slides.length) {slideIndex = 1}
        if (n < 1) {slideIndex = slides.length}
        
        for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
        }
        
        for (i = 0; i < dots.length; i++) {
          dots[i].className = dots[i].className.replace(" active", "");
        }
        
        slides[slideIndex-1].style.display = "block";
        dots[slideIndex-1].className += " active";
      }
      
      // Keyboard navigation
      document.addEventListener('keydown', function(e) {
        // Arrow keys for section navigation
        if (e.key === 'ArrowDown' || e.key === 'ArrowRight') {
          // Find current active section and navigate to next
          const activeLink = document.querySelector('.nav-link.active');
          const nextLink = activeLink.parentElement.nextElementSibling;
          
          if (nextLink) {
            nextLink.querySelector('a').click();
          }
        } else if (e.key === 'ArrowUp' || e.key === 'ArrowLeft') {
          // Find current active section and navigate to previous
          const activeLink = document.querySelector('.nav-link.active');
          const prevLink = activeLink.parentElement.previousElementSibling;
          
          if (prevLink) {
            prevLink.querySelector('a').click();
          }
        } else if (e.key === 'Home') {
          // Navigate to first section
          document.querySelector('.nav-link').click();
        } else if (e.key === 'End') {
          // Navigate to last section
          const navLinks = document.querySelectorAll('.nav-link');
          navLinks[navLinks.length - 1].click();
        } else if (e.key === 'Escape') {
          // Close mobile menu and TOC sidebar
          navLinksContainer.classList.remove('show');
          tocSidebar.classList.remove('show');
        }
      });
    });
  </script>
</body>
</html>
